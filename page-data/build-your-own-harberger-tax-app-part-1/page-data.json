{"componentChunkName":"component---src-templates-blog-post-js","path":"/build-your-own-harberger-tax-app-part-1/","result":{"data":{"avatar":{"childImageSharp":{"fixed":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGQABAAIDAAAAAAAAAAAAAAAAAAQFAQIG/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAbyr2qJOsQxIFZC//8QAHBAAAgICAwAAAAAAAAAAAAAAAQIAAwQTERIj/9oACAEBAAEFAi4Bqzdl0yXgPK0Hz1pNaToon//EABURAQEAAAAAAAAAAAAAAAAAABEg/9oACAEDAQE/AWP/xAAVEQEBAAAAAAAAAAAAAAAAAAARIP/aAAgBAgEBPwFj/8QAHRAAAgICAwEAAAAAAAAAAAAAAAECETEyEBKRgf/aAAgBAQAGPwI61UXjhr4Risxd2Zo1XhpHw1R//8QAHBABAAMAAwEBAAAAAAAAAAAAAQARITFBUYHx/9oACAEBAAE/Iam+XcEWcC7uCJZsHzzXkzTpKgrqHXCviKKt7zH5iHAD5P/aAAwDAQACAAMAAAAQIDh8/8QAGBEAAwEBAAAAAAAAAAAAAAAAAAEREDH/2gAIAQMBAT8QFT4RZ//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8QgTq3/8QAHhABAQACAgIDAAAAAAAAAAAAAREAITFRYcFx0fD/2gAIAQEAAT8Q2DDZ0xjb1N6L8/WUQDsca2HSTySVMNinAoEjt3dZGIiHQjz7xKtKkVfOfnvWWt01h25//9k=","width":50,"height":50,"src":"/static/3e54bfe31de3a0ebbeff4858d6101bba/99438/wildcards.jpg","srcSet":"/static/3e54bfe31de3a0ebbeff4858d6101bba/99438/wildcards.jpg 1x,\n/static/3e54bfe31de3a0ebbeff4858d6101bba/aba1d/wildcards.jpg 1.5x,\n/static/3e54bfe31de3a0ebbeff4858d6101bba/b315d/wildcards.jpg 2x"}}},"site":{"siteMetadata":{"title":"Wildcards Blog","author":"Team Wildcards","disqusShortname":"wildcardsworld"}},"markdownRemark":{"id":"2a441b08-08cd-5757-af17-affc70692f33","excerpt":"Build your first Harberger Tax App - Part 1 Wildcards has been running in production for many months, and all the code is opensource. However, we are yet to see…","html":"<h1>Build your first Harberger Tax App - Part 1</h1>\n<p>Wildcards has been running in production for many months, and all the code is opensource. However, we are yet to see a flourishing of applications built with harberger tax. This article aims to make the code that is used to build wildcards easily accessible to the public. There are quite a few manual steps in this tutorial, but if you follow everything step by step you will be able to have a default working harberger tax application on Ethereum with a UI in under 15 minutes.</p>\n<p>There are more links and explanations marked with the heading <strong><em>Extra</em></strong>. We highly encourage you to go through these, but if you just want to get started they are not necessary (and they will cause you to take longer than 15 minutes). If something goes wrong check if there are any <strong><em>NOTE</em></strong> sections. Otherwise please create an issue on github</p>\n<p>Once you have completed the basic tutorial we will explore how to customize your application by modifying the contracts and extending the UI. This toolkit is designed to be easy to get started with, yet, (or so we hope) infinitely customizable.</p>\n<h2>Contents:</h2>\n<p>This tutorial has 3 parts:</p>\n<ul>\n<li>First part is to deploy the smart contracts.</li>\n<li>Second part is to create a subgraph that allows you to easily query data from the blockchain.</li>\n<li>The final step is to run a sample UI</li>\n</ul>\n<blockquote>\n<p><strong><em>Aside</em></strong>: While we truly love thegraph and the power it gives, it also adds quite a lot of config and complexity to an application. I wouldn’t recommend using the graph for very small and quick projects, for that it is simpler to just query blockchain data directly from the blockchain via a provider such as <a href=\"https://infura.io\">infura.io</a>.</p>\n</blockquote>\n<h2>Get the contracts and deploy them.</h2>\n<blockquote>\n<p><strong><em>Extra</em></strong>: These contracts use <a href=\"https://github.com/OpenZeppelin/openzeppelin-sdk\">Zeppelin-SDK</a> to allow them to be up-gradable. Please go through their <a href=\"https://openzeppelin.com/sdk/\">docs</a> carefully to understand what this means and the requirements if you wish to upgrade.</p>\n</blockquote>\n<p>Clone the repository and install the dependencies:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/wildcards-world/harberger-base-contracts.git\n<span class=\"token builtin class-name\">cd</span> harberger-base-contracts\n<span class=\"token function\">yarn</span> <span class=\"token comment\"># You can also use `npm install` but yarn is recommended.</span></code></pre></div>\n<p>Then deploy the contracts to the goerli test network:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> migrate --network goerli</code></pre></div>\n<blockquote>\n<p><strong><em>NOTE</em></strong>: This command will take a few minutes</p>\n</blockquote>\n<blockquote>\n<p><strong><em>NOTE</em></strong>: If there is an issue with this command it is likely that someone has used/stolen all the goerli testnet eth that is stored by the private key hardcoded in this repo. Another possibility is that the infura keys are exhausted (since they are on free tier). Generate new keys <a href=\"https://iancoleman.io/bip39/\">here</a> and paste them into <code class=\"language-text\">./secrectsManager.example.js</code> to replace the old private key. If you want to use your own infura keys, generate them <a href=\"https://infura.io/\">here</a> and paste your keys into <code class=\"language-text\">./secrectsManager.example.js</code>.</p>\n</blockquote>\n<p>It should output something similar to this on completion.\n<img src=\"https://i.imgur.com/InsmRtH.png\" alt=\"Expected Output\"></p>\n<blockquote>\n<p><strong><em>Extra</em></strong>: these contracts currently use <a href=\"https://www.trufflesuite.com/docs/truffle/reference/configuration\">truffle</a> + <a href=\"https://www.trufflesuite.com/ganache\">ganache</a>, but over time the goal is to move it completely to <a href=\"https://buidler.dev/\">buidler</a>. At the moment you will find traces of configuration for both in the repo.</p>\n</blockquote>\n<p>Now that the contract is deployed to the goerli testnet we need to get the contract addresses. It is found in the <code class=\"language-text\">./openzeppelin/goerli.json</code> file near the bottom under <code class=\"language-text\">proxies &gt; &quot;the contract name&quot; &gt; address</code> as shown below:</p>\n<p><img src=\"https://i.imgur.com/GrASHKv.png\" alt=\"where-to-find-contract-addresses\">\nIn our case the address for the <em>HarbergerSteward</em> is <code class=\"language-text\">0x4bE0Eab8f41c8109AA134509086Cbcb18b10C0fB</code> and for the <em>ERC721Patronage</em> it is <code class=\"language-text\">0x48C12e1c5aBC5239FD6e2642C929E8FA8bE29999</code> - we will use these in the next steps, so keep them somewhere for reference.</p>\n<h2>Create a subgraph</h2>\n<p>This repo allows us to read data from the ethereum blockchain.</p>\n<blockquote>\n<p><strong><em>Extra</em></strong>: the subgraph is provided by thegraph.com . It uses graphQL which is a specification for how to structure data requests and it is a powerful tool because it allows you to fetch exactly the data you want from the graph. The UI library uses a library called <a href=\"https://www.apollographql.com/\">apollo</a> to fetch the data from the subgraph.</p>\n</blockquote>\n<p>Get the code and install the dependencies by running the following in a new terminal and folder:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/wildcards-world/harberger-base-subgraph.git\n<span class=\"token builtin class-name\">cd</span> harberger-base-subgraph\n<span class=\"token function\">yarn</span> <span class=\"token comment\"># Once again, you can use `npm install` if you prefer.</span></code></pre></div>\n<p>Next you will need to create an account with <a href=\"https://thegraph.com\">the Graph</a>. Once you have an account go to your dashboard and click the button that says “Add Subgraph” in the top right corner:</p>\n<p><img src=\"https://i.imgur.com/PsaZYQa.png\" alt=\"create-graph-button\"></p>\n<p>Fill in your preferred details for your new subgraph:\n<img src=\"https://i.imgur.com/DEnfDNu.png\" alt=\"create-graph\">\nOnce created it will present you with some default instructions. I have summarised them below.</p>\n<p>Install thegraph cli tool:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --global @graphprotocol/graph-cli</code></pre></div>\n<blockquote>\n<p><strong><em>NOTE</em></strong>: this command will take some time, so feel free to continue in the meantime. You do need this command to run the <code class=\"language-text\">graph auth</code> command below.</p>\n</blockquote>\n<p>Authenticate with thegraph. Copy the code in the top bar and run it in the following command:\n<img src=\"https://i.imgur.com/WlMCvdP.png\" alt=\"secret-graph-code\"></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">graph auth https://api.thegraph.com/deploy/ <span class=\"token operator\">&lt;</span>ACCESS_TOKEN<span class=\"token operator\">></span> <span class=\"token comment\"># find this access token as circled in the image above.</span></code></pre></div>\n<p><img src=\"https://i.imgur.com/9v6fsfP.png\" alt=\"success example\"></p>\n<p>You are ready to test deploying this graph. First change the <em>package.json</em> to point to the correct subgraph:\n<img src=\"https://i.imgur.com/ptkktvU.png\" alt=\"set-upstream-graph-endpoint\"></p>\n<p>For example if you github name is “jasoons” and your new subgraph is called “harberger-app” you should set this line to say <code class=\"language-text\">&quot;deploy&quot;: &quot;graph deploy --node https://api.thegraph.com/deploy/ --ipfs https://api.thegraph.com/ipfs/ jasoons/harberger-app&quot;,</code></p>\n<p>Next you need to auto-generate some setup code:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> codegen</code></pre></div>\n<blockquote>\n<p><strong><em>Extra</em></strong>: you will need to run this anytime you change the abi (which you will need to change anytime you change the interface of your contract) or your <code class=\"language-text\">subgraph.yaml</code> file. It generates helper code based on the interface (abi) of your contracts.</p>\n</blockquote>\n<p>You are now ready to deploy this version of the subgraph, but will it deploy the correct subgraph for your contracts? The answer is no, you need to tell the graph to watch the contracts you deployed in the previous step. To do that edit the <code class=\"language-text\">subgraph.yaml</code> file with the addresses that you deployed earlier:\n<img src=\"https://i.imgur.com/57uJWiN.png\" alt=\"set-contracts-in-graph\"></p>\n<p>Now run the deploy script with the correct contract addresses</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> deploy</code></pre></div>\n<p><img src=\"https://i.imgur.com/yyIGV4S.png\"></p>\n<p>Go to back your graph, reload the page and check that everything is working. It should look something like this:</p>\n<p><img src=\"https://i.imgur.com/XUk7WyD.png\" alt=\"thegraph-playground\"></p>\n<blockquote>\n<p><strong><em>Extra</em></strong>: The docs for thegraph.com are excelent. Do yourself a favour and read through them thoroughly, thegraph will likely help you build on Ethereum for many future projects.</p>\n</blockquote>\n<h2>Setup the basic UI</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> clone https://github.com/wildcards-world/harberger-ui.git\n<span class=\"token builtin class-name\">cd</span> harberger-ui\n<span class=\"token function\">yarn</span>\n<span class=\"token function\">yarn</span> re:build</code></pre></div>\n<p>The UI is configured to run with a single simple command:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> start</code></pre></div>\n<blockquote>\n<p><strong><em>EXTRA</em></strong>: You can do all your coding in Javascript or Typescript, however you can also use ReasonMl which is a new typesafe language which is being pioneered by facebook.</p>\n</blockquote>\n<p>Now you will need to set the contract address of the steward and the graph endpoint of your subgraph.</p>\n<p><img src=\"https://i.imgur.com/1sseS1J.png\"></p>\n<p>You should be able to now buy token #0 (the starter code has this value hardcoded) via the UI and set its price. To use the UI you will need to have the <a href=\"https://metamask.io/\">metamask</a>.</p>\n<p>To hit the ground running with your own custom UI code you will need to start with the <code class=\"language-text\">app.js</code> file. The code should be easy to follow.</p>\n<p>For doing more advanced enhancements to this code, check out tutorial #2 of this series!</p>\n<hr>\n<p>Visit our website <a href=\"https://wildcards.world\">Wildcards</a> where you can buy some wildcards and start contributing toward at risk animal conservation today! Follow our socials to learn more about our project and the conservation causes we are working towards.</p>\n<p>Follow us on twitter: <a href=\"https://twitter.com/wildcards_world\">@wildcards_world</a></p>\n<p>Follow us on Facebook: <a href=\"https://www.facebook.com/wildcardscrypto\">@wildcardscrypto</a></p>\n<p>Follow us on Telegram: <a href=\"https://t.me/wildcardsworld\">Telegram</a></p>\n<p>As always, stay cool, stay safe and stay tuned</p>\n<p>Team Wildcards</p>","frontmatter":{"title":"Build your first Harberger Tax App - Part 1","date":"May 27, 2020","description":"A tutorial that shows you all the parts that come together to create https://wildcards.world. It acts as a good starting point if you want to create your own app that uses harberger tax.","author":"Jason Smythe","featuredImage":{"childImageSharp":{"sizes":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAQFAQP/xAAVAQEBAAAAAAAAAAAAAAAAAAADBP/aAAwDAQACEAMQAAABpLNcDqoGiS//xAAbEAACAgMBAAAAAAAAAAAAAAABAgMSAAQRFP/aAAgBAQABBQLYlrkM3GVrLsR2zzKSoCj/xAAaEQACAgMAAAAAAAAAAAAAAAAAAQIDERJh/9oACAEDAQE/AYuvTDHw/8QAFhEBAQEAAAAAAAAAAAAAAAAAEQEQ/9oACAECAQE/Aauf/8QAGRAAAwEBAQAAAAAAAAAAAAAAAAERMRJB/9oACAEBAAY/AuYSb4VCZpEf/8QAGRABAAMBAQAAAAAAAAAAAAAAAQARITFR/9oACAEBAAE/IaKOjW4SY0wewi5MHdSNQIbBBJUE/9oADAMBAAIAAwAAABAP3//EABkRAAMAAwAAAAAAAAAAAAAAAAABETFBUf/aAAgBAwEBPxBfsyRXof/EABYRAQEBAAAAAAAAAAAAAAAAAAABQf/aAAgBAgEBPxDEj//EABoQAQEBAQEBAQAAAAAAAAAAAAERACExQYH/2gAIAQEAAT8Q6iIKRxfNFoUTx/WpNH76YvixstHWphITRdOBv//Z","aspectRatio":1.5,"src":"/static/1828f329f0e9ffa68b5d4691e229b3ef/4fe8c/red-balloon-sale.jpg","srcSet":"/static/1828f329f0e9ffa68b5d4691e229b3ef/aabdf/red-balloon-sale.jpg 150w,\n/static/1828f329f0e9ffa68b5d4691e229b3ef/9dc27/red-balloon-sale.jpg 300w,\n/static/1828f329f0e9ffa68b5d4691e229b3ef/4fe8c/red-balloon-sale.jpg 600w,\n/static/1828f329f0e9ffa68b5d4691e229b3ef/9842e/red-balloon-sale.jpg 900w,\n/static/1828f329f0e9ffa68b5d4691e229b3ef/47498/red-balloon-sale.jpg 1200w,\n/static/1828f329f0e9ffa68b5d4691e229b3ef/b2131/red-balloon-sale.jpg 3000w","sizes":"(max-width: 600px) 100vw, 600px"}}}}}},"pageContext":{"slug":"/build-your-own-harberger-tax-app-part-1/","previous":{"fields":{"slug":"/ethturin/"},"frontmatter":{"title":"Community governance through quadratic voting at Italy's first Ethereum hackathon [Remote edition]"}},"next":{"fields":{"slug":"/chainlink-vrf-wildcards/"},"frontmatter":{"title":"Announcing New Wildcards Features Powered By Chainlink VRF"}}}}}